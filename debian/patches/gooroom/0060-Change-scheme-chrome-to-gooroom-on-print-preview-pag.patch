From 8cb68a33b9d5ecbd64e41d4fa50e8d6adab898ae Mon Sep 17 00:00:00 2001
From: junsungc <junsungc@gooroom.kr>
Date: Mon, 27 Jul 2020 15:36:42 +0900
Subject: [PATCH 60/84] Change scheme chrome ://to gooroom:// on print preview
 page'

---
 .../ui/webui/print_preview/print_preview_handler.cc      | 9 +++++++++
 1 file changed, 9 insertions(+)

diff --git a/chrome/browser/ui/webui/print_preview/print_preview_handler.cc b/chrome/browser/ui/webui/print_preview/print_preview_handler.cc
index 5beb6ac1f575..dc8c85e76658 100644
--- a/chrome/browser/ui/webui/print_preview/print_preview_handler.cc
+++ b/chrome/browser/ui/webui/print_preview/print_preview_handler.cc
@@ -12,6 +12,10 @@
 #include <utility>
 #include <vector>
 
+#if defined(GOOROOM_BUILD)
+#include "gooroom/URLRewrite/gooroom_url_rewrite.h"
+#endif
+
 #include "base/base64.h"
 #include "base/bind.h"
 #include "base/callback_helpers.h"
@@ -602,7 +606,12 @@ void PrintPreviewHandler::HandleGetPreview(const base::ListValue* args) {
     url::Replacements<char> url_sanitizer;
     url_sanitizer.ClearUsername();
     url_sanitizer.ClearPassword();
+#if defined(GOOROOM_BUILD)
+    // Change "chrome://" to "gooroom://"
+    const GURL& initiator_url = GooroomURLRewrite::ChangeGooroomScheme(initiator->GetLastCommittedURL());
+#else
     const GURL& initiator_url = initiator->GetLastCommittedURL();
+#endif
     settings.SetKey(kSettingHeaderFooterURL,
                     base::Value(url_formatter::FormatUrl(
                         initiator_url.ReplaceComponents(url_sanitizer))));
-- 
2.20.1

