From 5c126f8a44cc0baf89a2f88341248454d0f34b65 Mon Sep 17 00:00:00 2001
From: junsungc <junsungc@gooroom.kr>
Date: Thu, 23 Jul 2020 14:59:35 +0900
Subject: [PATCH 10/63] register /gooroom/ as a external protocol and scheme

---
 chrome/browser/profiles/profile_io_data.cc | 4 ++++
 content/common/url_schemes.cc              | 4 ++++
 content/public/common/url_constants.cc     | 1 +
 content/public/common/url_constants.h      | 1 +
 4 files changed, 10 insertions(+)

diff --git a/chrome/browser/profiles/profile_io_data.cc b/chrome/browser/profiles/profile_io_data.cc
index 242c2e3f1fdd1..dcf7a0ec901d4 100644
--- a/chrome/browser/profiles/profile_io_data.cc
+++ b/chrome/browser/profiles/profile_io_data.cc
@@ -37,6 +37,10 @@ bool ProfileIOData::IsHandledProtocol(const std::string& scheme) {
     extensions::kExtensionScheme,
 #endif
     content::kChromeUIScheme,
+#if defined(GOOROOM_BUILD)
+    // Treat "gooroom://" as a external protocol
+    content::kGooroomUIScheme,
+#endif
     content::kChromeUIUntrustedScheme,
     url::kDataScheme,
 #if BUILDFLAG(IS_CHROMEOS_ASH)
diff --git a/content/common/url_schemes.cc b/content/common/url_schemes.cc
index e59440185a5fe..5e19c9cfaa9b8 100644
--- a/content/common/url_schemes.cc
+++ b/content/common/url_schemes.cc
@@ -59,6 +59,10 @@ void RegisterContentSchemes(bool should_lock_registry) {
 
   url::AddStandardScheme(kChromeDevToolsScheme, url::SCHEME_WITH_HOST);
   url::AddStandardScheme(kChromeUIScheme, url::SCHEME_WITH_HOST);
+  // Slightly tint string "gooroom://" viewed in location bar.
+#if defined(GOOROOM_BUILD)
+  url::AddStandardScheme(kGooroomUIScheme, url::SCHEME_WITH_HOST);
+#endif
   url::AddStandardScheme(kChromeUIUntrustedScheme, url::SCHEME_WITH_HOST);
   url::AddStandardScheme(kGuestScheme, url::SCHEME_WITH_HOST);
   url::AddStandardScheme(kChromeErrorScheme, url::SCHEME_WITH_HOST);
diff --git a/content/public/common/url_constants.cc b/content/public/common/url_constants.cc
index 6122c0beac3d0..f2a3f8a1b9181 100644
--- a/content/public/common/url_constants.cc
+++ b/content/public/common/url_constants.cc
@@ -13,6 +13,7 @@ namespace content {
 // There are security implications associated with introducing new schemes.
 const char kChromeDevToolsScheme[] = "devtools";
 const char kChromeErrorScheme[] = "chrome-error";
+const char kGooroomUIScheme[] = "gooroom";
 const char kChromeUIScheme[] = "chrome";
 const char kChromeUIUntrustedScheme[] = "chrome-untrusted";
 const char kGuestScheme[] = "chrome-guest";
diff --git a/content/public/common/url_constants.h b/content/public/common/url_constants.h
index 587304b973f50..f47c6b27eacd2 100644
--- a/content/public/common/url_constants.h
+++ b/content/public/common/url_constants.h
@@ -19,6 +19,7 @@ namespace content {
 // from there.
 CONTENT_EXPORT extern const char kChromeDevToolsScheme[];
 CONTENT_EXPORT extern const char kChromeErrorScheme[];
+CONTENT_EXPORT extern const char kGooroomUIScheme[]; // Used for WebUIs.
 CONTENT_EXPORT extern const char kChromeUIScheme[];  // Used for WebUIs.
 CONTENT_EXPORT extern const char kChromeUIUntrustedScheme[];
 CONTENT_EXPORT extern const char kGuestScheme[];
-- 
2.30.2

