From 63cd69cb395afeb910cf5d3de58c063de61497df Mon Sep 17 00:00:00 2001
From: junsungc <junsungc@gooroom.kr>
Date: Mon, 27 Jul 2020 15:36:42 +0900
Subject: [PATCH 61/85] Change scheme chrome ://to gooroom:// on print preview
 page'

---
 .../ui/webui/print_preview/print_preview_handler.cc      | 9 +++++++++
 1 file changed, 9 insertions(+)

diff --git a/chrome/browser/ui/webui/print_preview/print_preview_handler.cc b/chrome/browser/ui/webui/print_preview/print_preview_handler.cc
index 67aa6bc0d76e..d3c2ea1b734b 100644
--- a/chrome/browser/ui/webui/print_preview/print_preview_handler.cc
+++ b/chrome/browser/ui/webui/print_preview/print_preview_handler.cc
@@ -12,6 +12,10 @@
 #include <utility>
 #include <vector>
 
+#if defined(GOOROOM_BUILD)
+#include "gooroom/URLRewrite/gooroom_url_rewrite.h"
+#endif
+
 #include "base/base64.h"
 #include "base/bind.h"
 #include "base/callback_helpers.h"
@@ -601,7 +605,12 @@ void PrintPreviewHandler::HandleGetPreview(const base::ListValue* args) {
     url::Replacements<char> url_sanitizer;
     url_sanitizer.ClearUsername();
     url_sanitizer.ClearPassword();
+#if defined(GOOROOM_BUILD)
+    // Change "chrome://" to "gooroom://"
+    const GURL& initiator_url = GooroomURLRewrite::ChangeGooroomScheme(initiator->GetLastCommittedURL());
+#else
     const GURL& initiator_url = initiator->GetLastCommittedURL();
+#endif
     settings.SetKey(kSettingHeaderFooterURL,
                     base::Value(url_formatter::FormatUrl(
                         initiator_url.ReplaceComponents(url_sanitizer))));
-- 
2.20.1

